# app/.Rprofile
local({
  # app/ est le working dir quand runApp(app/) est lancé
  app_dir <- normalizePath(getwd(), winslash = "/", mustWork = TRUE)
  root <- normalizePath(file.path(app_dir, ".."), winslash = "/", mustWork = TRUE)

  lib_app  <- file.path(root, "library")      # recommandé
  lib_r    <- file.path(root, "R", "library") # fallback runtime

  paths <- c()
  if (dir.exists(lib_app)) paths <- c(paths, lib_app)
  if (dir.exists(lib_r))   paths <- c(paths, lib_r)

  if (length(paths) == 0) {
    warning("Aucune librairie locale trouvée (library/ ou R/library/).")
  } else {
    .libPaths(paths)
  }
})
